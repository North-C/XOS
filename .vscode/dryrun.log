make --dry-run --always-make --keep-going --print-directory
make: Entering directory '/root/project/OS'
 
echo 编译汇编文件 boot/grub_head.s ...
nasm -f elf -g -F stabs boot/grub_head.s
echo 编译代码文件 boot/boot.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 boot/boot.c -o boot/boot.o
echo 编译代码文件 arch/i386/kernel/init_task.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 arch/i386/kernel/init_task.c -o arch/i386/kernel/init_task.o
echo 编译代码文件 arch/i386/kernel/setup.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 arch/i386/kernel/setup.c -o arch/i386/kernel/setup.o
echo 编译代码文件 kernel/panic.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 kernel/panic.c -o kernel/panic.o
echo 编译代码文件 kernel/printk.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 kernel/printk.c -o kernel/printk.o
echo 编译代码文件 kernel/console.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 kernel/console.c -o kernel/console.o
echo 编译代码文件 init/main.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 init/main.c -o init/main.o
echo 编译代码文件 lib/vsprintf.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 lib/vsprintf.c -o lib/vsprintf.o
echo 编译代码文件 lib/ctype.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 lib/ctype.c -o lib/ctype.o
echo 编译代码文件 lib/string.c ...
gcc -I ./include/ -c -fno-builtin -m32 -fno-stack-protector -nostdinc -fno-pic -gdwarf-2 lib/string.c -o lib/string.o
 
echo 链接内核文件...
ld -T scripts/kernel.ld -m elf_i386 -nostdlib -Map /root/project/OS/build/kernel.map  ./boot/grub_head.o  ./boot/boot.o  ./arch/i386/kernel/init_task.o  ./arch/i386/kernel/setup.o  ./kernel/panic.o  ./kernel/printk.o  ./kernel/console.o  ./init/main.o  ./lib/vsprintf.o  ./lib/ctype.o  ./lib/string.o -o /root/project/OS/build/kernel.bin
cp ./build/kernel.bin ./hdisk/boot/
sleep 1
make: Leaving directory '/root/project/OS'
 
